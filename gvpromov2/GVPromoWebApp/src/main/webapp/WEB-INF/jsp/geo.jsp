<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" isELIgnored="false"%>
<!DOCTYPE html>
<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script>
    var baseURL = "http://localhost:8084/GVPromoWebApp/api/store_region";
    
    function sendEntity2(cities, area_id){
        $.ajax({
	  url: "api/store_area?area_api_id=" + area_id,
          method: "POST",
          contentType : "application/json",
	  dataType: "json",
          data: JSON.stringify(cities)
	});
 
    }
//2984, 2985, 40530, 112, 2993, 2995, 
var regions_code_array = 
[
'1484',
'3816',
'1580',
'3343',
'38736',
'3307',
'3329',
'1486',
'2697',
'3344',
'17735',
'3351',
'3279',
'2745',
'3311',
'3281',
'3337',
'17736',
'3342',
'17776',
'1552',
'2694',
'3350',
'3964',
'3336',
'28391',
'2741',
'2834',
'3312',
'2746',
'3282',
'3348',
'17738',
'8',
'3954',
'3334',
'2870',
'2715',
'2132',
'4070',
'2699',
'3283',
'3194',
'2692',
'1551',
'2743',
'2700',
'17777',
'3952',
'3318',
'40861',
'3222',
'3319',
'2776',
'2857',
'3284',
'1804',
'2701',
'3286',
'1924',
'2846',
'3288',
'3433',
'118',
'3290',
'3316',
'3293',
'2702',
'39997',
'3802',
'3325',
'3294',
'2748',
'3865',
'3297',
'2693',
'2991',
'3982',
'17778',
'3148',
'17780',
'17781',
'1932',
'3280',
'2703',
'2742',
'17439',
'3946',
'2749',
'3300',
'3322',
'143',
'2750',
'3963',
'2751',
'17529',
'4096',
'3950',
'3301',
'3324',
'17782',
'17747',
'2986',
'3335',
'3326',
'3304',
'33715',
'1920',
'3305',
'1553',
'3947',
'3306',
'129',
'3845',
'1928',
'1483',
'3330',
'3327',
'2705',
'3439',
'2706',
'3437',
'3328',
'1214',
'2707',
'2955',
'614',
'1213',
'4101',
'2708',
'17427',
'19',
'3949',
'2711',
'4102',
'17757',
'3955',
'2695',
'2713',
'2721',
'2698',
'2722',
'3953',
'17763',
'2723',
'643',
'2725',
'2726',
'3948',
'2727',
'2728',
'2756',
'36873',
'2774',
'1485',
'644',
'2914',
'38',
'17132',
'2775',
'1058',
'2852',
'2789',
'2854',
'2830',
'2930',
'2912',
'2836',
'2837',
'2932',
'2832',
'2779',
'2757',
'2856',
'2921',
'39721',
'2762',
'2845',
'2839',
'3757',
'1201',
'1477',
'16477',
'2780',
'2840',
'128',
'2841',
'2781',
'2868',
'2923',
'1805',
'2782',
'3790',
'1488',
'1208',
'2853',
'4064',
'2786',
'619',
'2763',
'3984',
'2859',
'2047',
'2842',
'2787',
'4023',
'2922',
'2054',
'1489',
'2788',
'2862',
'2934',
'1056',
'2759',
'1739',
'2909',
'2935',
'2855',
'2941',
'17441',
'1249',
'2765',
'2942',
'2773',
'2864',
'586',
'5',
'2917',
'1060',
'2865',
'2766',
'2838',
'1490',
'1066',
'2956',
'2943',
'2843',
'17410',
'2866',
'1198',
'2768',
'4025',
'2867',
'2764',
'2945',
'2875',
'2769',
'2946',
'2847',
'2760',
'2947',
'3353',
'1182',
'2948',
'2876',
'2949',
'1055',
'17472',
'2872',
'2761',
'4022',
'2877',
'2950',
'2771',
'150',
'2772',
'2149',
'2951',
'2952',
'1930',
'2851',
'4108',
'2878',
'2953',
'2958',
'17501',
'2960',
'2961',
'2944',
'2962',
'44117',
'2963',
'2964',
'2965',
'2966',
'2931',
'4010',
'2967',
'2972',
'2954',
'2968',
'2969',
'2062',
'3034',
'2860',
'2970',
'3',
'17784',
'2913',
'1509',
'8059',
'1578',
'613',
'1200',
'3037',
'589',
'3730',
'4052',
'2971',
'1522',
'960',
'2978',
'628',
'3039',
'3040',
'17454',
'661',
'2974',
'1192',
'3041',
'2871',
'2975',
'2976',
'1510',
'1608',
'2680',
'1193',
'1307',
'20',
'3235',
'1204',
'2135',
'17440',
'3035',
'3897',
'3639',
'3046',
'2977',
'3898',
'1315',
'3902',
'3903',
'3904',
'3906',
'3907',
'3069',
'3921',
'47961',
'17785',
'3908',
'1585',
'3910',
'3911',
'3912',
'3913',
'3054',
'3055',
'17434',
'3061',
'33707',
'17503',
'3066',
'3070',
'17528',
'3899',
'3057',
'3914',
'16631',
'2143',
'3065',
'3072',
'3916',
'3915',
'3917',
'3047',
'3909',
'3073',
'3063',
'3918',
'3062',
'3919',
'3048',
'3980',
'3973',
'955',
'3905',
'3920',
'17844',
'3896',
'115',
'27733',
'3900',
'3056',
'16674',
'3922',
'4076',
'48',
'34982',
'17465',
'16503',
'3076',
'17442',
'2144',
'3059',
'3075',
'1053',
'247',
'38662',
'3082',
'3100',
'4055',
'3099',
'4058',
'43578',
'3101',
'3106',
'2134',
'38661',
'3108',
'621',
'1547',
'3302',
'18',
'1574',
'3109',
'4057',
'2770',
'1545',
'3103',
'38663',
'3044',
'17633',
'4056',
'1475',
'3111',
'2716',
'622',
'2929',
'1541',
'3743',
'1248',
'3084',
'1504',
'3744',
'38660',
'3112',
'4029',
'3085',
'3113',
'2682',
'3086',
'3087',
'3105',
'646',
'3088',
'3104',
'37412',
'3036',
'30931',
'1051',
'35356',
'3234',
'3216',
'3217',
'585',
'4035',
'1186',
'3967',
'4068',
'3083',
'964',
'3156',
'1560',
'3448',
'17788',
'3121',
'3238',
'4036',
'3449',
'4012',
'3218',
'1246',
'29364',
'17789',
'3092',
'3158',
'3706',
'17404',
'3957',
'3220',
'1512',
'3159',
'3122',
'3240',
'3221',
'3169',
'3242',
'3164',
'3116',
'14664',
'3991',
'3243',
'3118',
'3214',
'3450',
'4090',
'3244',
'3451',
'17422',
'983',
'17400',
'3206',
'3610',
'3245',
'3452',
'16350',
'3224',
'4013',
'3123',
'17838',
'47841',
'3207',
'3165',
'1536',
'3166',
'1513',
'42702',
'3225',
'3453',
'3249',
'984',
'3455',
'591',
'3192',
'3167',
'17443',
'17428',
'37443',
'976',
'3058',
'3252',
'3253',
'2145',
'961',
'3150',
'32618',
'17496',
'3226',
'3208',
'2052',
'3151',
'3071',
'3168',
'3456',
'3152',
'17461',
'3153',
'43450',
'3255',
'3457',
'3258',
'2147',
'3972',
'3170',
'3205',
'3259',
'17481',
'3171',
'3260',
'3155',
'2820',
'3154',
'16318',
'3285',
'35005',
'40514',
'3458',
'1481',
'3261',
'136',
'3277',
'3990',
'3172',
'46902',
'3173',
'40078',
'3968',
'3174',
'587',
'3459',
'44014',
'4078',
'3460',
'137',
'3107',
'17506',
'3209',
'3157',
'3461',
'3175',
'3462',
'3176',
'3463',
'1209',
'3464',
'3262',
'3178',
'3203',
'21772',
'3227',
'1062',
'4014',
'969',
'3179',
'3867',
'17431',
'4034',
'3263',
'2718',
'44585',
'3264',
'3228',
'17412',
'3465',
'3180',
'3181',
'3229',
'966',
'4172',
'3466',
'17509',
'3182',
'3230',
'3211',
'3183',
'1816',
'17437',
'987',
'17793',
'3270',
'3958',
'17421',
'3992',
'3191',
'977',
'3184',
'8055',
'40884',
'39388',
'3185',
'2754',
'3271',
'3469',
'3177',
'3231',
'3274',
'3186',
'17794',
'2053',
'4098',
'3275',
'3212',
'1537',
'3187',
'3276',
'3213',
'3188',
'17839',
'4079',
'3278',
'40479',
'3237',
'17610',
'47057',
'583',
'3412',
'41725',
'3470',
'10',
'3471',
'1063',
'3472',
'4033',
'3233',
'3232',
'18448',
'17631',
'43089',
'50813',
'36775',
'51930'
];

 
    
    function sendEntity(object){
      $.ajax({
	  url: "api/store_region",
          method: "POST",
	  contentType : "application/json",
	  dataType: "json",
	  data: JSON.stringify(object)
	});
    }
    $(document).ready(function(){
	var url = "";
        //проходимся по всем регионам (пока только один регион)
        var j;
        for(var i= regions_code_array.length - 1; i >=0; i--)
        {   j = i;
            url = "http://htmlweb.ru/geo/api.php?rajon_city="+regions_code_array[j] + "&xml";
            console.log(url);
            $.ajax({
              async: false,
              url: url,
              dataType: 'xml'
            })
           .success(function(data)
           {    console.log(data);
                /*var areas = new Array(); 
                if (data.error !== undefined)
                    return;
                for(var i in data)
                {   var area = new Object();          
                    area['name'] = data[i].name;
                    areas.push(area);
                }               
                console.log(regions_code_array[j]);
                sendEntity2(areas, regions_code_array[j]); */
                
                var regions = new Array();
                $(data).find("msg").each(function()
                {                
                  var region = new Object();
                  //region['apiId'] = $(this).find("id").text();
                  region['name'] = $(this).find("name").text(); 
                  regions.push(region);
                });
                if (regions.length !== 0)
                {
                    console.log(regions_code_array[j]);
                    //sendEntity2(regions, regions_code_array[j]);
                }
            })
            .done(function() {
                console.log("done");
            });
        }
    });
  </script>
</head>
<body>
    <h1>тестовый скрипт для заполнения базы</h1>
</body>
</html>
